<div ng-controller="BusScheduleController as busController">
  <div class="row nav-bar-schedule">
    <a href="/app/#/buses/"><button 
      class="btn btn-primary">
        <span class="glyphicon glyphicon-list"></span>
        Вернуться к списку автобусов 
    </button></a>
  </div>

  <div class="well well-lg square-borders">
    <div class="row" ng-show="hideMenu">
      <button 
        ng-click="busController.hideButton()" 
        class="btn btn-success centerized"
        id="show-menu-button">
          <span class="glyphicon glyphicon-list"></span>
          Показать меню
      </button>
      <div class="row schedule-menu-well well">
        <div id="bus-number">{{currentBus.name}}</div>
      </div>
    </div>
  
  <!-- @Menu @start --> 
  <div class="row" ng-hide="hideMenu">
    <div class="col-md-6 well well-lg schedule-menu-well" id="stations-choosing-container">
      <div class="checkbox-container schedule-menu-group" data-toggle="buttons">
        <p>Остановки:</p>
      
        <label 
          ng-repeat="i in currentBus.stations track by $index"
          ng-click="busController.stationClicked(i)"
          ng-class="{active: currentBus.stations[$index].selected}"
          class="btn btn-default square-borders">
          <input
            type="checkbox" 
            ng-model="currentBus.stations[$index].selected"
            checked> 
              {{currentBus.stations[$index].name}} 
          </input>
        </label> 
      </div>
      <div class="row" id="choose-all-row"> 
        <button 
          ng-click="busController.setAllStationsChecked()"
          class="btn btn-success centerized"
          id="choose-all-button">
          <span class="glyphicon glyphicon-ok"></span>
         Выбрать все 
        </button>
      </div>
    </div>
   

    <div class="col-md-4 schedule-menu-group schedule-menu-well well well-lg">
      <div class="row" data-toggle="buttons">
        <div class="schedule-menu-button-row">Сегодня {{daysOfWeek[currentDay]}}, {{dayEndString}} день.</div>
        <label 
          class="btn btn-default schedule-menu-button "
          ng-class="{active: isSelectedWorkdays}"
          ng-click="busController.setCurrentWorkdays()">
            <input 
            type="radio" 
            name="options" 
            id="option1" 
            checked>
              Рабочий день
        </label>
        <label class="btn btn-default schedule-menu-button"
          ng-class="{active: !isSelectedWorkdays}"
          ng-click="busController.setCurrentWeekend()">
            <input 
            type="radio" 
            name="options" 
            id="option2"> 
              Выходной
        </label>
      </div>

      <div class="row schedule-menu-button-row">
        <div>Фильтрация по времени:</div>
        <div class="schedule-menu-button-row">
          <select 
            ng-model="selectedHour"
            ng-options="i for i in hours"> 
          </select> 
          <select 
            ng-model="selectedMinute"
            ng-options="i for i in minutes"> 
          </select> 
        </div>
        <button 
          ng-click="busController.setCurrentTime()" 
          class="btn schedule-menu-button">
            Текущее время
            (<span current-time></span>)
        </button>
        <button 
          ng-click="busController.setNullTime()"
          class="btn btn-danger schedule-menu-button">
          <span class="glyphicon glyphicon-remove"></span>
          Сбросить 
        </button>
      </div>

      <div class="row">
        <label> 
          <input type="checkbox" ng-model="busController.highlightOn">Подсвечивать уехавшие автобусы</input>
        </label> 
      </div>

    </div>
    
    <div class="col-md-2 schedule-menu-group schedule-menu-well well well-lg">
      <div id="bus-number">{{currentBus.name}}</div>
    </div>
  </div>
  <!-- @Menu @end --> 
   
  
<!--
<div class="dropdown">
  <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown">
    Dropdown
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Action</a></li>
    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Another action</a></li>
    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Something else here</a></li>
    <li role="presentation" class="divider"></li>
    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Separated link</a></li>
  </ul>
</div>
-->
    <div 
      ng-hide="hideMenu" 
      class="row">
        <button 
          ng-click="busController.hideButton()" 
          class="btn btn-primary centerized">
          <span class="glyphicon glyphicon-chevron-up"></span>
            Скрыть меню
        </button>
    </div>
  </div>

  <div class="schedule-table">
    <table class="table table-striped" oci.fixed-header>
      <thead> 
        <tr>
          <th ng-repeat="station in currentBus.stations track by $index"
              ng-show="checkedStations[$index].selected"
              class="schedule-header">
            {{station.name}}   
          </th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="bus in currentSchedule | filtertime:selectedHour:selectedMinute"> 
          <td ng-show="checkedStations[$index].selected"
              ng-repeat="time in bus  track by $index "
              ng-class="{'text-danger': busController.isTimeExpired(time) && busController.highlightOn}">
            {{time}}
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
